// Copyright (c) CLMS. All rights reserved.
// Licensed under the AGPL-3.0 license. See LICENSE file in the project root for full license information.
// This source file was autogenerated by zAppDev(r).
using System.Collections.Generic;
using System.Linq;
using System.Collections.Concurrent;
using System.Reflection;
using zAppDev.DotNet.Framework.Data;
using Microsoft.Extensions.Configuration;

using DSS1_RetailerDriverStockOptimisation.BO;
using DSS1_RetailerDriverStockOptimisation.DAL;
using Identity = zAppDev.DotNet.Framework.Identity;
using zAppDev.DotNet.Framework.Identity;
using zAppDev.DotNet.Framework.Identity.Model;

namespace DSS1_RetailerDriverStockOptimisation
{
    public class DatabaseSeeder
    {
        private ConcurrentDictionary<string, ApplicationPermission> _applicationPermissionDictionary = null;
        private IConfiguration configuration;

        public DatabaseSeeder(IConfiguration configuration = null)
        {
            this.configuration = configuration;
        }

        private ApplicationPermission CreateOrUpdatePermission(string name, string description, bool isCustom, Repository repo)
        {
            if (_applicationPermissionDictionary == null)
            {
                _applicationPermissionDictionary = new ConcurrentDictionary<string, ApplicationPermission>();
                var applicationPermissions = repo.Get<ApplicationPermission>(a => a.Name != null);
                foreach (var item in applicationPermissions)
                {
                    if (!_applicationPermissionDictionary.ContainsKey(item.Name))
                    {
                        _applicationPermissionDictionary.TryAdd(item.Name, item);
                    }
                }
            }
            bool update = false;
            ApplicationPermission p = null;
            if (_applicationPermissionDictionary.ContainsKey(name))
            {
                p = _applicationPermissionDictionary[name];
                if (p.IsCustom != isCustom)
                {
                    p.IsCustom = isCustom;
                    update = true;
                }
                if (p.Description != description)
                {
                    p.Description = description;
                    update = true;
                }
            }
            else
            {
                update = true;
                p = new ApplicationPermission();
                p.Name = name;
                p.IsCustom = isCustom;
                p.Description = description;
            }
            if (update)
            {
                repo.Save(p);
            }
            return p;
        }


        private ConcurrentDictionary<string, ApplicationOperation> _applicationOperationDictionary = null;


        private string GetApplicationOperationKey(string name, string parent, string type)
        {
            return name + '|' + parent + '|' + type;
        }

        private ApplicationOperation CreateOrUpdateOperation(string name, string parent, string type,
                bool isAvailableToAllAuthorizedUsers,
                bool isAvailableToAnonymous, IEnumerable<ApplicationPermission> perms, Repository repo)
        {
            if (_applicationOperationDictionary == null)
            {
                _applicationOperationDictionary = new ConcurrentDictionary<string, ApplicationOperation>();
                var applicationOperations = repo.Get<ApplicationOperation>(a => a.Name != null);
                foreach (ApplicationOperation item in applicationOperations)
                {
                    string key = GetApplicationOperationKey(item.Name, item.ParentControllerName, item.Type);
                    if (!_applicationOperationDictionary.ContainsKey(key))
                    {
                        _applicationOperationDictionary.TryAdd(key, item);
                    }
                }
            }
            ApplicationOperation op = null;
            string currentKey = GetApplicationOperationKey(name, parent, type);
            bool update = false;
            if (_applicationOperationDictionary.ContainsKey(currentKey))
            {
                op = _applicationOperationDictionary[currentKey];
                if (op.IsAvailableToAllAuthorizedUsers != isAvailableToAllAuthorizedUsers)
                {
                    op.IsAvailableToAllAuthorizedUsers = isAvailableToAllAuthorizedUsers;
                    update = true;
                }
                if (op.IsAvailableToAnonymous != isAvailableToAnonymous)
                {
                    op.IsAvailableToAnonymous = isAvailableToAnonymous;
                    update = true;
                }
                List<ApplicationPermission> applicationPermissions = op.Permissions.Where(p => !p.IsCustom).ToList();
                HandleApplicationPermissions<ApplicationOperation>(op, applicationPermissions, perms, ref update);
            }
            else
            {
                update = true;
                op = new ApplicationOperation();
                op.Name = name;
                op.Type = type;
                op.IsAvailableToAllAuthorizedUsers = isAvailableToAllAuthorizedUsers;
                op.IsAvailableToAnonymous = isAvailableToAnonymous;
                op.ParentControllerName = parent;
                if (perms != null)
                {
                    foreach (var p in perms)
                    {
                        op.AddPermissions(p);
                    }
                }
            }
            if (update)
            {
                repo.Save(op);
            }
            return op;
        }



        private ConcurrentDictionary<string, ApplicationRole> _applicationRoleDictionary = null;
        private ApplicationRole CreateOrUpdateRole(string name, string description, IEnumerable<ApplicationPermission> perms, Repository repo)
        {
            if (_applicationRoleDictionary == null)
            {
                _applicationRoleDictionary = new ConcurrentDictionary<string, ApplicationRole>();
                var applicationRoles = repo.Get<ApplicationRole>(a => a.Name != null);
                foreach (ApplicationRole item in applicationRoles)
                {
                    if (!_applicationRoleDictionary.ContainsKey(item.Name))
                    {
                        _applicationRoleDictionary.TryAdd(item.Name, item);
                    }
                }
            }
            ApplicationRole role = null;
            bool update = false;
            if (_applicationRoleDictionary.ContainsKey(name))
            {
                role = _applicationRoleDictionary[name];
                if (role.Description != description)
                {
                    role.Description = description;
                    update = true;
                }
                if (role.IsCustom != false)
                {
                    role.IsCustom = false;
                    update = true;
                }
                List<ApplicationPermission> applicationPermissions = role.Permissions.Where(p => !p.IsCustom).ToList();
                HandleApplicationPermissions<ApplicationRole>(role, applicationPermissions, perms, ref update);
            }
            else
            {
                update = true;
                role = new ApplicationRole();
                role.Name = name;
                role.Description = description;
                role.IsCustom = false;
                if (perms != null)
                {
                    foreach (var p in perms)
                    {
                        role.AddPermissions(p);
                    }
                }
            }
            if (update)
            {
                repo.Save(role);
            }
            return role;
        }


        private void RemoveApplicationPermissions<T>(T objT, List<ApplicationPermission> applicationPermissions)
        {
            MethodInfo removePermissions = typeof(T).GetMethod("RemovePermissions");
            foreach (var p in applicationPermissions)
            {
                removePermissions.Invoke(objT, new object[] { p });
            }
        }



        private void AddApplicationPermissions<T>(T objT,IEnumerable<ApplicationPermission> perms)
        {
            MethodInfo addPermissions = typeof(T).GetMethod("AddPermissions", new[] { typeof(ApplicationPermission) });
            foreach (var p in perms)
            {
                addPermissions.Invoke(objT, new object[] { p });
            }
        }


        private void HandleApplicationPermissions<T>(T objT, List<ApplicationPermission> applicationPermissions,
                IEnumerable<ApplicationPermission> perms,ref bool update)
        {
            if (perms == null)
            {
                if (applicationPermissions != null && applicationPermissions.Count > 0)
                {
                    update = true;
                    RemoveApplicationPermissions<T>(objT, applicationPermissions);
                }
            }
            else if (perms.Any())
            {
                if (applicationPermissions == null || applicationPermissions.Count == 0)
                {
                    update = true;
                    AddApplicationPermissions<T>(objT, perms);
                }
                else
                {
                    if (perms.Count() != applicationPermissions.Count)
                    {
                        update = true;
                        RemoveApplicationPermissions<T>(objT, applicationPermissions);
                        AddApplicationPermissions<T>(objT, perms);
                    }
                    else
                    {
                        bool diffFound = false;
                        foreach (var p in perms)
                        {
                            //if (!applicationPermissions.Contains(p))
                            var checkApplicationPermission = applicationPermissions.FirstOrDefault(a => a.Name == p.Name);
                            if (checkApplicationPermission == null)
                            {
                                diffFound = true;
                                break;
                            }
                        }
                        if (diffFound)
                        {
                            update = true;
                            RemoveApplicationPermissions<T>(objT, applicationPermissions);
                            AddApplicationPermissions<T>(objT, perms);
                        }
                    }
                }
            }
        }



        public void UpdateAuthorizationTables()
        {
            var confValue = System.Configuration.ConfigurationManager.AppSettings["SeedSecurityTables"];
            bool seedSecurityTables = true;
            bool bSeedSecurityTables;
            if (bool.TryParse(confValue, out bSeedSecurityTables))
            {
                seedSecurityTables = bSeedSecurityTables;
            }
            if(!seedSecurityTables) return;
            var watch = new System.Diagnostics.Stopwatch();
            watch.Start();
            MiniSessionManager.ExecuteInUoW(manager =>
            {
                var repo = new Repository(manager);
                var allRoles = new List<ApplicationRole>();
                #region Permissions
                var manageUsersPermission = CreateOrUpdatePermission("ManageUsers", "Can Manage Users", false, repo);
                var manageRolesPermission = CreateOrUpdatePermission("ManageRoles", "Can Manage Roles", false, repo);
                var managePermissionsPermission = CreateOrUpdatePermission("ManagePermissions", "Can Manage Permissions", false, repo);
                var manageOperationsPermission = CreateOrUpdatePermission("ManageOperations", "Can Manage Operations", false, repo);
                var manageSettingsPermission = CreateOrUpdatePermission("ManageSettings", "Can Manage Settings", false, repo);
                var manageApplicationDataPermission = CreateOrUpdatePermission("ManageApplicationData", "Can Manage Application Data", false, repo);
                var customerSelectionAndAdminAddPermission = CreateOrUpdatePermission("CustomerSelectionAndAdmin_Add", "CustomerSelectionAndAdmin_Add", false, repo);
                var canViewOrderForecastPermission = CreateOrUpdatePermission("CanViewOrderForecast", "Can View Order Forecast", false, repo);
                var canViewEditableOrderForecastPermission = CreateOrUpdatePermission("CanViewEditableOrderForecast", "Can View Editable Order Forecast", false, repo);
                var isSupplierPermission = CreateOrUpdatePermission("IsSupplier", "Is Supplier", false, repo);
                var isStockManagerPermission = CreateOrUpdatePermission("IsStockManager", "Is Stock Manager", false, repo);
                #endregion
                #region Operations
                CreateOrUpdateOperation("GeneralOperation", "ErrorPage", ClaimTypes.GenericAction, true, true, null, repo);
                CreateOrUpdateOperation("Render", "ErrorPage", ClaimTypes.ControllerAction, true, true, null, repo);
                CreateOrUpdateOperation("SendErrorToAdministrator", "ErrorPage", ClaimTypes.ControllerAction, true, true, null, repo);
                CreateOrUpdateOperation("GeneralOperation", "FirstAdminSetup", ClaimTypes.GenericAction, true, false, null, repo);
                CreateOrUpdateOperation("Render", "FirstAdminSetup", ClaimTypes.ControllerAction, true, false, null, repo);
                CreateOrUpdateOperation("Save", "FirstAdminSetup", ClaimTypes.ControllerAction, true, false, null, repo);
                CreateOrUpdateOperation("GeneralOperation", "HomePage", ClaimTypes.GenericAction, true, false, null, repo);
                CreateOrUpdateOperation("Render", "HomePage", ClaimTypes.ControllerAction, true, false, null, repo);
                CreateOrUpdateOperation("GeneralOperation", "NotFoundPage", ClaimTypes.GenericAction, true, true, null, repo);
                CreateOrUpdateOperation("Render", "NotFoundPage", ClaimTypes.ControllerAction, true, true, null, repo);
                CreateOrUpdateOperation("GeneralOperation", "SignInPage", ClaimTypes.GenericAction, false, true, null, repo);
                CreateOrUpdateOperation("Load", "SignInPage", ClaimTypes.ControllerAction, false, true, null, repo);
                CreateOrUpdateOperation("SignIn", "SignInPage", ClaimTypes.ControllerAction, false, true, null, repo);
                CreateOrUpdateOperation("GeneralOperation", "SignOutPage", ClaimTypes.GenericAction, true, false, null, repo);
                CreateOrUpdateOperation("SignOut", "SignOutPage", ClaimTypes.ControllerAction, true, false, null, repo);
                CreateOrUpdateOperation("Render", "SignOutPage", ClaimTypes.ControllerAction, false, true, null, repo);
                CreateOrUpdateOperation("GeneralOperation", "Unauthorized", ClaimTypes.GenericAction, true, true, null, repo);
                CreateOrUpdateOperation("Render", "Unauthorized", ClaimTypes.ControllerAction, true, true, null, repo);
                CreateOrUpdateOperation("GeneralOperation", "UserPreferences", ClaimTypes.GenericAction, true, false, null, repo);
                CreateOrUpdateOperation("Render", "UserPreferences", ClaimTypes.ControllerAction, true, false, null, repo);
                CreateOrUpdateOperation("Save", "UserPreferences", ClaimTypes.ControllerAction, true, false, null, repo);
                CreateOrUpdateOperation("LanguageBoxDataSet", "UserPreferences", ClaimTypes.Dataset, true, false, null, repo);
                CreateOrUpdateOperation("LocaleBoxDataSet", "UserPreferences", ClaimTypes.Dataset, true, false, null, repo);
                CreateOrUpdateOperation("GeneralOperation", "MasterPage", ClaimTypes.GenericAction, true, true, null, repo);
                CreateOrUpdateOperation("Render", "MasterPage", ClaimTypes.ControllerAction, true, true, null, repo);
                CreateOrUpdateOperation("SignOut", "MasterPage", ClaimTypes.ControllerAction, true, false, null, repo);
                CreateOrUpdateOperation("NotificationRead", "MasterPage", ClaimTypes.ControllerAction, true, false, null, repo);
                CreateOrUpdateOperation("AppNotifications", "MasterPage", ClaimTypes.Dataset, true, true, null, repo);
                CreateOrUpdateOperation("GeneralOperation", "MasterPageForSlide", ClaimTypes.GenericAction, true, true, null, repo);
                CreateOrUpdateOperation("Render", "MasterPageForSlide", ClaimTypes.ControllerAction, true, true, null, repo);
                CreateOrUpdateOperation("GeneralOperation", "ApplicationSettingForm", ClaimTypes.GenericAction, false, false,
                                        new [] { manageSettingsPermission }, repo);
                CreateOrUpdateOperation("AddApplicationSetting", "ApplicationSettingForm", ClaimTypes.ControllerAction, false, false,
                                        new [] { manageSettingsPermission }, repo);
                CreateOrUpdateOperation("EditApplicationSetting", "ApplicationSettingForm", ClaimTypes.ControllerAction, false, false,
                                        new [] { manageSettingsPermission }, repo);
                CreateOrUpdateOperation("SaveApplicationSetting", "ApplicationSettingForm", ClaimTypes.ControllerAction, false, false,
                                        new [] { manageSettingsPermission }, repo);
                CreateOrUpdateOperation("DeleteApplicationSetting", "ApplicationSettingForm", ClaimTypes.ControllerAction, false, false,
                                        new [] { manageSettingsPermission }, repo);
                CreateOrUpdateOperation("GeneralOperation", "ApplicationSettingsList", ClaimTypes.GenericAction, false, false,
                                        new [] { manageSettingsPermission }, repo);
                CreateOrUpdateOperation("Refresh", "ApplicationSettingsList", ClaimTypes.ControllerAction, false, false,
                                        new [] { manageUsersPermission }, repo);
                CreateOrUpdateOperation("Retrieve", "ApplicationSettingsList", ClaimTypes.ControllerAction, false, false,
                                        new [] { manageSettingsPermission }, repo);
                CreateOrUpdateOperation("List1DataSet", "ApplicationSettingsList", ClaimTypes.Dataset, false, false,
                                        new [] { manageSettingsPermission }, repo);
                CreateOrUpdateOperation("GeneralOperation", "ChangePassword", ClaimTypes.GenericAction, true, false, null, repo);
                CreateOrUpdateOperation("Render", "ChangePassword", ClaimTypes.ControllerAction, true, false, null, repo);
                CreateOrUpdateOperation("ChangePassword", "ChangePassword", ClaimTypes.ControllerAction, true, false, null, repo);
                CreateOrUpdateOperation("GeneralOperation", "ForgotPassword", ClaimTypes.GenericAction, false, true, null, repo);
                CreateOrUpdateOperation("Render", "ForgotPassword", ClaimTypes.ControllerAction, false, true, null, repo);
                CreateOrUpdateOperation("ResetPassword", "ForgotPassword", ClaimTypes.ControllerAction, false, true, null, repo);
                CreateOrUpdateOperation("GeneralOperation", "ManageOperation", ClaimTypes.GenericAction, false, false,
                                        new [] { manageOperationsPermission }, repo);
                CreateOrUpdateOperation("EditOperation", "ManageOperation", ClaimTypes.ControllerAction, false, false,
                                        new [] { manageOperationsPermission }, repo);
                CreateOrUpdateOperation("SaveOperation", "ManageOperation", ClaimTypes.ControllerAction, false, false,
                                        new [] { manageOperationsPermission }, repo);
                CreateOrUpdateOperation("Button2Changed", "ManageOperation", ClaimTypes.ControllerAction, true, true, null, repo);
                CreateOrUpdateOperation("Button2DataSet", "ManageOperation", ClaimTypes.Dataset, false, false,
                                        new [] { manageOperationsPermission }, repo);
                CreateOrUpdateOperation("GeneralOperation", "ManagePermission", ClaimTypes.GenericAction, false, false,
                                        new [] { managePermissionsPermission }, repo);
                CreateOrUpdateOperation("NewPermission", "ManagePermission", ClaimTypes.ControllerAction, false, false,
                                        new [] { managePermissionsPermission }, repo);
                CreateOrUpdateOperation("EditPermission", "ManagePermission", ClaimTypes.ControllerAction, false, false,
                                        new [] { managePermissionsPermission }, repo);
                CreateOrUpdateOperation("SavePermission", "ManagePermission", ClaimTypes.ControllerAction, false, false,
                                        new [] { managePermissionsPermission }, repo);
                CreateOrUpdateOperation("DeletePermission", "ManagePermission", ClaimTypes.ControllerAction, false, false,
                                        new [] { managePermissionsPermission }, repo);
                CreateOrUpdateOperation("Button4Changed", "ManagePermission", ClaimTypes.ControllerAction, true, true, null, repo);
                CreateOrUpdateOperation("Button41Changed", "ManagePermission", ClaimTypes.ControllerAction, true, true, null, repo);
                CreateOrUpdateOperation("Button5Changed", "ManagePermission", ClaimTypes.ControllerAction, true, true, null, repo);
                CreateOrUpdateOperation("Button4DataSet", "ManagePermission", ClaimTypes.Dataset, false, false,
                                        new [] { managePermissionsPermission }, repo);
                CreateOrUpdateOperation("Button41DataSet", "ManagePermission", ClaimTypes.Dataset, false, false,
                                        new [] { managePermissionsPermission }, repo);
                CreateOrUpdateOperation("Button5DataSet", "ManagePermission", ClaimTypes.Dataset, false, false,
                                        new [] { managePermissionsPermission }, repo);
                CreateOrUpdateOperation("GeneralOperation", "ManageRole", ClaimTypes.GenericAction, false, false,
                                        new [] { manageRolesPermission }, repo);
                CreateOrUpdateOperation("NewRole", "ManageRole", ClaimTypes.ControllerAction, false, false,
                                        new [] { manageRolesPermission }, repo);
                CreateOrUpdateOperation("EditRole", "ManageRole", ClaimTypes.ControllerAction, false, false,
                                        new [] { manageRolesPermission }, repo);
                CreateOrUpdateOperation("SaveRole", "ManageRole", ClaimTypes.ControllerAction, false, false,
                                        new [] { manageRolesPermission }, repo);
                CreateOrUpdateOperation("DeleteRole", "ManageRole", ClaimTypes.ControllerAction, false, false,
                                        new [] { manageRolesPermission }, repo);
                CreateOrUpdateOperation("AddPermissionChanged", "ManageRole", ClaimTypes.ControllerAction, true, true, null, repo);
                CreateOrUpdateOperation("AddPermissionDataSet", "ManageRole", ClaimTypes.Dataset, false, false,
                                        new [] { manageRolesPermission }, repo);
                CreateOrUpdateOperation("GeneralOperation", "ManageUser", ClaimTypes.GenericAction, false, false,
                                        new [] { manageUsersPermission }, repo);
                CreateOrUpdateOperation("NewUser", "ManageUser", ClaimTypes.ControllerAction, false, false,
                                        new [] { manageUsersPermission }, repo);
                CreateOrUpdateOperation("EditUser", "ManageUser", ClaimTypes.ControllerAction, false, false,
                                        new [] { manageUsersPermission }, repo);
                CreateOrUpdateOperation("SaveUser", "ManageUser", ClaimTypes.ControllerAction, false, false,
                                        new [] { manageUsersPermission }, repo);
                CreateOrUpdateOperation("DeleteUser", "ManageUser", ClaimTypes.ControllerAction, false, false,
                                        new [] { manageUsersPermission }, repo);
                CreateOrUpdateOperation("Button1Changed", "ManageUser", ClaimTypes.ControllerAction, true, true, null, repo);
                CreateOrUpdateOperation("Button2Changed", "ManageUser", ClaimTypes.ControllerAction, true, true, null, repo);
                CreateOrUpdateOperation("Button1DataSet", "ManageUser", ClaimTypes.Dataset, false, false,
                                        new [] { manageUsersPermission }, repo);
                CreateOrUpdateOperation("Button2DataSet", "ManageUser", ClaimTypes.Dataset, false, false,
                                        new [] { manageUsersPermission }, repo);
                CreateOrUpdateOperation("GeneralOperation", "OperationsList", ClaimTypes.GenericAction, false, false,
                                        new [] { manageOperationsPermission }, repo);
                CreateOrUpdateOperation("Refresh", "OperationsList", ClaimTypes.ControllerAction, false, false,
                                        new [] { manageUsersPermission }, repo);
                CreateOrUpdateOperation("Retrieve", "OperationsList", ClaimTypes.ControllerAction, false, false,
                                        new [] { manageOperationsPermission }, repo);
                CreateOrUpdateOperation("List1DataSet", "OperationsList", ClaimTypes.Dataset, false, false,
                                        new [] { manageOperationsPermission }, repo);
                CreateOrUpdateOperation("GeneralOperation", "PermissionsList", ClaimTypes.GenericAction, false, false,
                                        new [] { managePermissionsPermission }, repo);
                CreateOrUpdateOperation("Refresh", "PermissionsList", ClaimTypes.ControllerAction, false, false,
                                        new [] { manageUsersPermission }, repo);
                CreateOrUpdateOperation("Retrieve", "PermissionsList", ClaimTypes.ControllerAction, false, false,
                                        new [] { managePermissionsPermission }, repo);
                CreateOrUpdateOperation("List1DataSet", "PermissionsList", ClaimTypes.Dataset, false, false,
                                        new [] { managePermissionsPermission }, repo);
                CreateOrUpdateOperation("GeneralOperation", "RolesList", ClaimTypes.GenericAction, false, false,
                                        new [] { manageRolesPermission }, repo);
                CreateOrUpdateOperation("Refresh", "RolesList", ClaimTypes.ControllerAction, false, false,
                                        new [] { manageUsersPermission }, repo);
                CreateOrUpdateOperation("Retrieve", "RolesList", ClaimTypes.ControllerAction, false, false,
                                        new [] { manageRolesPermission }, repo);
                CreateOrUpdateOperation("List1DataSet", "RolesList", ClaimTypes.Dataset, false, false,
                                        new [] { manageRolesPermission }, repo);
                CreateOrUpdateOperation("GeneralOperation", "UsersList", ClaimTypes.GenericAction, false, false,
                                        new [] { manageUsersPermission }, repo);
                CreateOrUpdateOperation("Retrieve", "UsersList", ClaimTypes.ControllerAction, false, false,
                                        new [] { manageUsersPermission }, repo);
                CreateOrUpdateOperation("Refresh", "UsersList", ClaimTypes.ControllerAction, false, false,
                                        new [] { manageUsersPermission }, repo);
                CreateOrUpdateOperation("List1DataSet", "UsersList", ClaimTypes.Dataset, false, false,
                                        new [] { manageUsersPermission }, repo);
                CreateOrUpdateOperation("GeneralOperation", "MasterPageSignIn", ClaimTypes.GenericAction, true, false, null, repo);
                CreateOrUpdateOperation("Render", "MasterPageSignIn", ClaimTypes.ControllerAction, true, false, null, repo);
                CreateOrUpdateOperation("GeneralOperation", "CreateAdmin", ClaimTypes.GenericAction, false, true, null, repo);
                CreateOrUpdateOperation("Index", "CreateAdmin", ClaimTypes.ControllerAction, false, true, null, repo);
                CreateOrUpdateOperation("Create", "CreateAdmin", ClaimTypes.ControllerAction, false, true, null, repo);
                CreateOrUpdateOperation("AuthorizeAccess", "CreateAdmin", ClaimTypes.ControllerAction, false, true, null, repo);
                CreateOrUpdateOperation("GeneralOperation", "AdminDashboard", ClaimTypes.GenericAction, true, true, null, repo);
                CreateOrUpdateOperation("Render", "AdminDashboard", ClaimTypes.ControllerAction, true, true, null, repo);
                CreateOrUpdateOperation("GeneralOperation", "AgreementForm", ClaimTypes.GenericAction, true, false, null, repo);
                CreateOrUpdateOperation("AddAgreement", "AgreementForm", ClaimTypes.ControllerAction, true, false, null, repo);
                CreateOrUpdateOperation("EditAgreement", "AgreementForm", ClaimTypes.ControllerAction, true, false, null, repo);
                CreateOrUpdateOperation("SaveAgreement", "AgreementForm", ClaimTypes.ControllerAction, true, true, null, repo);
                CreateOrUpdateOperation("DeleteAgreement", "AgreementForm", ClaimTypes.ControllerAction, true, true, null, repo);
                CreateOrUpdateOperation("FullTruckDS", "AgreementForm", ClaimTypes.Dataset, true, false, null, repo);
                CreateOrUpdateOperation("GeneralOperation", "AgreementList", ClaimTypes.GenericAction, false, false,
                                        new [] { isStockManagerPermission }, repo);
                CreateOrUpdateOperation("Retrieve", "AgreementList", ClaimTypes.ControllerAction, false, false,
                                        new [] { isStockManagerPermission }, repo);
                CreateOrUpdateOperation("AgreementDataSet", "AgreementList", ClaimTypes.Dataset, false, false,
                                        new [] { isStockManagerPermission }, repo);
                CreateOrUpdateOperation("GeneralOperation", "Analytics", ClaimTypes.GenericAction, false, false,
                                        new [] { manageApplicationDataPermission }, repo);
                CreateOrUpdateOperation("Render", "Analytics", ClaimTypes.ControllerAction, false, false,
                                        new [] { manageApplicationDataPermission }, repo);
                CreateOrUpdateOperation("LogsDataset", "Analytics", ClaimTypes.Dataset, false, false,
                                        new [] { manageApplicationDataPermission }, repo);
                CreateOrUpdateOperation("Top5ServiceDataset", "Analytics", ClaimTypes.Dataset, false, false,
                                        new [] { manageApplicationDataPermission }, repo);
                CreateOrUpdateOperation("Top5OperationDataset", "Analytics", ClaimTypes.Dataset, false, false,
                                        new [] { manageApplicationDataPermission }, repo);
                CreateOrUpdateOperation("Top5ConsumerDataset", "Analytics", ClaimTypes.Dataset, false, false,
                                        new [] { manageApplicationDataPermission }, repo);
                CreateOrUpdateOperation("ErrorRequestDataset", "Analytics", ClaimTypes.Dataset, false, false,
                                        new [] { manageApplicationDataPermission }, repo);
                CreateOrUpdateOperation("RequestOverTimeDataset", "Analytics", ClaimTypes.Dataset, false, false,
                                        new [] { manageApplicationDataPermission }, repo);
                CreateOrUpdateOperation("RequestLatencyDataset", "Analytics", ClaimTypes.Dataset, false, false,
                                        new [] { manageApplicationDataPermission }, repo);
                CreateOrUpdateOperation("GeneralOperation", "CalculationsForm", ClaimTypes.GenericAction, false, false,
                                        new [] { manageUsersPermission }, repo);
                CreateOrUpdateOperation("CalculateOrderDate", "CalculationsForm", ClaimTypes.ControllerAction, true, false, null, repo);
                CreateOrUpdateOperation("CreateNotifications", "CalculationsForm", ClaimTypes.ControllerAction, true, false, null, repo);
                CreateOrUpdateOperation("CalcReplenishmentCycle", "CalculationsForm", ClaimTypes.ControllerAction, true, true, null, repo);
                CreateOrUpdateOperation("CalcQuantity", "CalculationsForm", ClaimTypes.ControllerAction, true, true, null, repo);
                CreateOrUpdateOperation("Render", "CalculationsForm", ClaimTypes.ControllerAction, false, false,
                                        new [] { manageUsersPermission }, repo);
                CreateOrUpdateOperation("RandomDates", "CalculationsForm", ClaimTypes.ControllerAction, true, false, null, repo);
                CreateOrUpdateOperation("AddSupplierCapacities", "CalculationsForm", ClaimTypes.ControllerAction, true, false, null, repo);
                CreateOrUpdateOperation("NewWastePerSKU", "CalculationsForm", ClaimTypes.ControllerAction, true, false, null, repo);
                CreateOrUpdateOperation("SLADelivery", "CalculationsForm", ClaimTypes.ControllerAction, true, false, null, repo);
                CreateOrUpdateOperation("SLALeadTime", "CalculationsForm", ClaimTypes.ControllerAction, true, false, null, repo);
                CreateOrUpdateOperation("platform", "CalculationsForm", ClaimTypes.ControllerAction, true, false, null, repo);
                CreateOrUpdateOperation("CalculateAvg", "CalculationsForm", ClaimTypes.ControllerAction, true, false, null, repo);
                CreateOrUpdateOperation("CalculateSLADelivery", "CalculationsForm", ClaimTypes.ControllerAction, true, false, null, repo);
                CreateOrUpdateOperation("CalculateSLALeadTime", "CalculationsForm", ClaimTypes.ControllerAction, true, false, null, repo);
                CreateOrUpdateOperation("CalcDifferentDays", "CalculationsForm", ClaimTypes.ControllerAction, true, false, null, repo);
                CreateOrUpdateOperation("CallDailyStock", "CalculationsForm", ClaimTypes.ControllerAction, true, false, null, repo);
                CreateOrUpdateOperation("CalculateDailyStockUnits", "CalculationsForm", ClaimTypes.ControllerAction, true, false, null, repo);
                CreateOrUpdateOperation("CalcAvgDailyDemandForecast", "CalculationsForm", ClaimTypes.ControllerAction, true, false, null, repo);
                CreateOrUpdateOperation("CalculateCurrentInvDays", "CalculationsForm", ClaimTypes.ControllerAction, true, false, null, repo);
                CreateOrUpdateOperation("CalculateMonthlySLADelivery", "CalculationsForm", ClaimTypes.ControllerAction, true, false, null, repo);
                CreateOrUpdateOperation("CalculateMonthlyLeadTime", "CalculationsForm", ClaimTypes.ControllerAction, true, false, null, repo);
                CreateOrUpdateOperation("FixSLAMonth", "CalculationsForm", ClaimTypes.ControllerAction, true, false, null, repo);
                CreateOrUpdateOperation("SupplierWarehouses", "CalculationsForm", ClaimTypes.ControllerAction, true, false, null, repo);
                CreateOrUpdateOperation("AvailableStock", "CalculationsForm", ClaimTypes.ControllerAction, true, false, null, repo);
                CreateOrUpdateOperation("GetSupplierCapacities", "CalculationsForm", ClaimTypes.ControllerAction, true, false, null, repo);
                CreateOrUpdateOperation("TestingFullTruck", "CalculationsForm", ClaimTypes.ControllerAction, true, false, null, repo);
                CreateOrUpdateOperation("ResetAllData", "CalculationsForm", ClaimTypes.ControllerAction, true, false, null, repo);
                CreateOrUpdateOperation("FillDeliveryScheduleNameDay", "CalculationsForm", ClaimTypes.ControllerAction, true, false, null, repo);
                CreateOrUpdateOperation("FixDBWeekday", "CalculationsForm", ClaimTypes.ControllerAction, true, false, null, repo);
                CreateOrUpdateOperation("FixDatesTest", "CalculationsForm", ClaimTypes.ControllerAction, true, false, null, repo);
                CreateOrUpdateOperation("CalculateOrderForecastAccuracy", "CalculationsForm", ClaimTypes.ControllerAction, true, false, null, repo);
                CreateOrUpdateOperation("SalesForecasts", "CalculationsForm", ClaimTypes.Dataset, false, false,
                                        new [] { manageUsersPermission }, repo);
                CreateOrUpdateOperation("OrderForecasts", "CalculationsForm", ClaimTypes.Dataset, false, false,
                                        new [] { manageUsersPermission }, repo);
                CreateOrUpdateOperation("GeneralOperation", "ItemOrderForecast", ClaimTypes.GenericAction, true, false, null, repo);
                CreateOrUpdateOperation("Render", "ItemOrderForecast", ClaimTypes.ControllerAction, true, false, null, repo);
                CreateOrUpdateOperation("CalcQuantity", "ItemOrderForecast", ClaimTypes.ControllerAction, true, true, null, repo);
                CreateOrUpdateOperation("CalcReplenishmentCycle", "ItemOrderForecast", ClaimTypes.ControllerAction, true, true, null, repo);
                CreateOrUpdateOperation("CalculateOrderDate", "ItemOrderForecast", ClaimTypes.ControllerAction, true, true, null, repo);
                CreateOrUpdateOperation("OrderForecastPerSKU", "ItemOrderForecast", ClaimTypes.ControllerAction, true, false, null, repo);
                CreateOrUpdateOperation("CreateNotifications", "ItemOrderForecast", ClaimTypes.ControllerAction, true, true, null, repo);
                CreateOrUpdateOperation("RefreshCharts", "ItemOrderForecast", ClaimTypes.ControllerAction, true, false, null, repo);
                CreateOrUpdateOperation("OrderProposalDataSet", "ItemOrderForecast", ClaimTypes.Dataset, true, false, null, repo);
                CreateOrUpdateOperation("OrderProposalsDS", "ItemOrderForecast", ClaimTypes.Dataset, true, false, null, repo);
                CreateOrUpdateOperation("Warehouse107", "ItemOrderForecast", ClaimTypes.Dataset, true, false, null, repo);
                CreateOrUpdateOperation("Warehouse108", "ItemOrderForecast", ClaimTypes.Dataset, true, false, null, repo);
                CreateOrUpdateOperation("Suppliers", "ItemOrderForecast", ClaimTypes.Dataset, true, false, null, repo);
                CreateOrUpdateOperation("Items", "ItemOrderForecast", ClaimTypes.Dataset, true, false, null, repo);
                CreateOrUpdateOperation("Warehouse105", "ItemOrderForecast", ClaimTypes.Dataset, true, false, null, repo);
                CreateOrUpdateOperation("Warehouse104", "ItemOrderForecast", ClaimTypes.Dataset, true, false, null, repo);
                CreateOrUpdateOperation("Warehouse1243", "ItemOrderForecast", ClaimTypes.Dataset, true, false, null, repo);
                CreateOrUpdateOperation("Warehouse1284", "ItemOrderForecast", ClaimTypes.Dataset, true, false, null, repo);
                CreateOrUpdateOperation("Warehouse107VM", "ItemOrderForecast", ClaimTypes.Dataset, true, false, null, repo);
                CreateOrUpdateOperation("Chart105VM", "ItemOrderForecast", ClaimTypes.Dataset, true, false, null, repo);
                CreateOrUpdateOperation("Chart108VM", "ItemOrderForecast", ClaimTypes.Dataset, true, false, null, repo);
                CreateOrUpdateOperation("Chart104VM", "ItemOrderForecast", ClaimTypes.Dataset, true, false, null, repo);
                CreateOrUpdateOperation("Chart107VM", "ItemOrderForecast", ClaimTypes.Dataset, true, false, null, repo);
                CreateOrUpdateOperation("Chart1243VM", "ItemOrderForecast", ClaimTypes.Dataset, true, false, null, repo);
                CreateOrUpdateOperation("Chart1284VM", "ItemOrderForecast", ClaimTypes.Dataset, true, false, null, repo);
                CreateOrUpdateOperation("GeneralOperation", "KPIDashboard", ClaimTypes.GenericAction, false, false,
                                        new [] { isStockManagerPermission }, repo);
                CreateOrUpdateOperation("Render", "KPIDashboard", ClaimTypes.ControllerAction, false, false,
                                        new [] { isStockManagerPermission }, repo);
                CreateOrUpdateOperation("AddSubcategory", "KPIDashboard", ClaimTypes.ControllerAction, true, false, null, repo);
                CreateOrUpdateOperation("RefreshFilters", "KPIDashboard", ClaimTypes.ControllerAction, true, false, null, repo);
                CreateOrUpdateOperation("AddSKU", "KPIDashboard", ClaimTypes.ControllerAction, true, false, null, repo);
                CreateOrUpdateOperation("ViewFiltered", "KPIDashboard", ClaimTypes.ControllerAction, true, false, null, repo);
                CreateOrUpdateOperation("WasteDataSet", "KPIDashboard", ClaimTypes.Dataset, false, false,
                                        new [] { isStockManagerPermission }, repo);
                CreateOrUpdateOperation("PlatformDataSet", "KPIDashboard", ClaimTypes.Dataset, false, false,
                                        new [] { isStockManagerPermission }, repo);
                CreateOrUpdateOperation("SLADelivery", "KPIDashboard", ClaimTypes.Dataset, false, false,
                                        new [] { isStockManagerPermission }, repo);
                CreateOrUpdateOperation("SLALeadMonthly", "KPIDashboard", ClaimTypes.Dataset, false, false,
                                        new [] { isStockManagerPermission }, repo);
                CreateOrUpdateOperation("UnitsKPIDataSet", "KPIDashboard", ClaimTypes.Dataset, false, false,
                                        new [] { isStockManagerPermission }, repo);
                CreateOrUpdateOperation("InventoryDaysKPIDataSet", "KPIDashboard", ClaimTypes.Dataset, false, false,
                                        new [] { isStockManagerPermission }, repo);
                CreateOrUpdateOperation("CategoryDataSet", "KPIDashboard", ClaimTypes.Dataset, false, false,
                                        new [] { isStockManagerPermission }, repo);
                CreateOrUpdateOperation("SubCategoryDataSet", "KPIDashboard", ClaimTypes.Dataset, false, false,
                                        new [] { isStockManagerPermission }, repo);
                CreateOrUpdateOperation("BusinessUnitDataSet", "KPIDashboard", ClaimTypes.Dataset, false, false,
                                        new [] { isStockManagerPermission }, repo);
                CreateOrUpdateOperation("OrderForecastsDS", "KPIDashboard", ClaimTypes.Dataset, false, false,
                                        new [] { isStockManagerPermission }, repo);
                CreateOrUpdateOperation("ForecastVS", "KPIDashboard", ClaimTypes.Dataset, false, false,
                                        new [] { isStockManagerPermission }, repo);
                CreateOrUpdateOperation("StockDataSet", "KPIDashboard", ClaimTypes.Dataset, false, false,
                                        new [] { isStockManagerPermission }, repo);
                CreateOrUpdateOperation("NotificationsDS", "KPIDashboard", ClaimTypes.Dataset, false, false,
                                        new [] { isStockManagerPermission }, repo);
                CreateOrUpdateOperation("SelectedOrderForecastDetailsDS", "KPIDashboard", ClaimTypes.Dataset, false, false,
                                        new [] { isStockManagerPermission }, repo);
                CreateOrUpdateOperation("AllSubcategoriesDS", "KPIDashboard", ClaimTypes.Dataset, false, false,
                                        new [] { isStockManagerPermission }, repo);
                CreateOrUpdateOperation("ItemsDS", "KPIDashboard", ClaimTypes.Dataset, false, false,
                                        new [] { isStockManagerPermission }, repo);
                CreateOrUpdateOperation("ItemsVMDS", "KPIDashboard", ClaimTypes.Dataset, false, false,
                                        new [] { isStockManagerPermission }, repo);
                CreateOrUpdateOperation("AllBaseUnitsDS", "KPIDashboard", ClaimTypes.Dataset, false, false,
                                        new [] { isStockManagerPermission }, repo);
                CreateOrUpdateOperation("SuppliersDS", "KPIDashboard", ClaimTypes.Dataset, false, false,
                                        new [] { isStockManagerPermission }, repo);
                CreateOrUpdateOperation("WarehousesDS", "KPIDashboard", ClaimTypes.Dataset, false, false,
                                        new [] { isStockManagerPermission }, repo);
                CreateOrUpdateOperation("GeneralOperation", "KPIDashboardViewOnly", ClaimTypes.GenericAction, false, false,
                                        new [] { isStockManagerPermission }, repo);
                CreateOrUpdateOperation("Render", "KPIDashboardViewOnly", ClaimTypes.ControllerAction, false, false,
                                        new [] { isStockManagerPermission }, repo);
                CreateOrUpdateOperation("AddSubcategory", "KPIDashboardViewOnly", ClaimTypes.ControllerAction, true, false, null, repo);
                CreateOrUpdateOperation("RefreshFilters", "KPIDashboardViewOnly", ClaimTypes.ControllerAction, true, false, null, repo);
                CreateOrUpdateOperation("AddSKU", "KPIDashboardViewOnly", ClaimTypes.ControllerAction, true, false, null, repo);
                CreateOrUpdateOperation("ViewFiltered", "KPIDashboardViewOnly", ClaimTypes.ControllerAction, false, false,
                                        new [] { isStockManagerPermission }, repo);
                CreateOrUpdateOperation("WasteDataSet", "KPIDashboardViewOnly", ClaimTypes.Dataset, false, false,
                                        new [] { isStockManagerPermission }, repo);
                CreateOrUpdateOperation("PlatformDataSet", "KPIDashboardViewOnly", ClaimTypes.Dataset, false, false,
                                        new [] { isStockManagerPermission }, repo);
                CreateOrUpdateOperation("SLADelivery", "KPIDashboardViewOnly", ClaimTypes.Dataset, false, false,
                                        new [] { isStockManagerPermission }, repo);
                CreateOrUpdateOperation("SLALeadMonthly", "KPIDashboardViewOnly", ClaimTypes.Dataset, false, false,
                                        new [] { isStockManagerPermission }, repo);
                CreateOrUpdateOperation("UnitsKPIDataSet", "KPIDashboardViewOnly", ClaimTypes.Dataset, false, false,
                                        new [] { isStockManagerPermission }, repo);
                CreateOrUpdateOperation("InventoryDaysKPIDataSet", "KPIDashboardViewOnly", ClaimTypes.Dataset, false, false,
                                        new [] { isStockManagerPermission }, repo);
                CreateOrUpdateOperation("CategoryDataSet", "KPIDashboardViewOnly", ClaimTypes.Dataset, false, false,
                                        new [] { isStockManagerPermission }, repo);
                CreateOrUpdateOperation("SubCategoryDataSet", "KPIDashboardViewOnly", ClaimTypes.Dataset, false, false,
                                        new [] { isStockManagerPermission }, repo);
                CreateOrUpdateOperation("BusinessUnitDataSet", "KPIDashboardViewOnly", ClaimTypes.Dataset, false, false,
                                        new [] { isStockManagerPermission }, repo);
                CreateOrUpdateOperation("OrderForecastsDS", "KPIDashboardViewOnly", ClaimTypes.Dataset, false, false,
                                        new [] { isStockManagerPermission }, repo);
                CreateOrUpdateOperation("NotificationsDS", "KPIDashboardViewOnly", ClaimTypes.Dataset, false, false,
                                        new [] { isStockManagerPermission }, repo);
                CreateOrUpdateOperation("SelectedOrderForecastDetailsDS", "KPIDashboardViewOnly", ClaimTypes.Dataset, false, false,
                                        new [] { isStockManagerPermission }, repo);
                CreateOrUpdateOperation("AllSubcategoriesDS", "KPIDashboardViewOnly", ClaimTypes.Dataset, false, false,
                                        new [] { isStockManagerPermission }, repo);
                CreateOrUpdateOperation("ItemsDS", "KPIDashboardViewOnly", ClaimTypes.Dataset, false, false,
                                        new [] { isStockManagerPermission }, repo);
                CreateOrUpdateOperation("ItemsVMDS", "KPIDashboardViewOnly", ClaimTypes.Dataset, false, false,
                                        new [] { isStockManagerPermission }, repo);
                CreateOrUpdateOperation("AllBaseUnitsDS", "KPIDashboardViewOnly", ClaimTypes.Dataset, false, false,
                                        new [] { isStockManagerPermission }, repo);
                CreateOrUpdateOperation("SuppliersDS", "KPIDashboardViewOnly", ClaimTypes.Dataset, false, false,
                                        new [] { isStockManagerPermission }, repo);
                CreateOrUpdateOperation("WarehousesDS", "KPIDashboardViewOnly", ClaimTypes.Dataset, false, false,
                                        new [] { isStockManagerPermission }, repo);
                CreateOrUpdateOperation("GeneralOperation", "NewDashboard", ClaimTypes.GenericAction, true, false, null, repo);
                CreateOrUpdateOperation("Render", "NewDashboard", ClaimTypes.ControllerAction, true, false, null, repo);
                CreateOrUpdateOperation("LeadTimeDay", "NewDashboard", ClaimTypes.ControllerAction, true, true, null, repo);
                CreateOrUpdateOperation("AssignValues", "NewDashboard", ClaimTypes.ControllerAction, true, true, null, repo);
                CreateOrUpdateOperation("AssignSKUinChart", "NewDashboard", ClaimTypes.ControllerAction, true, true, null, repo);
                CreateOrUpdateOperation("afterSelectingSKU", "NewDashboard", ClaimTypes.ControllerAction, true, false, null, repo);
                CreateOrUpdateOperation("refresh", "NewDashboard", ClaimTypes.ControllerAction, true, false, null, repo);
                CreateOrUpdateOperation("clearBelowBusinessUnits", "NewDashboard", ClaimTypes.ControllerAction, true, false, null, repo);
                CreateOrUpdateOperation("clearBelowCat", "NewDashboard", ClaimTypes.ControllerAction, true, false, null, repo);
                CreateOrUpdateOperation("ClearBelowSubCat", "NewDashboard", ClaimTypes.ControllerAction, true, false, null, repo);
                CreateOrUpdateOperation("clearItem", "NewDashboard", ClaimTypes.ControllerAction, true, false, null, repo);
                CreateOrUpdateOperation("StockOnHandDataSet", "NewDashboard", ClaimTypes.Dataset, true, false, null, repo);
                CreateOrUpdateOperation("SalesForecastDataSet", "NewDashboard", ClaimTypes.Dataset, true, false, null, repo);
                CreateOrUpdateOperation("StatisticsDataSet", "NewDashboard", ClaimTypes.Dataset, true, false, null, repo);
                CreateOrUpdateOperation("StatisticsSKUDataSet", "NewDashboard", ClaimTypes.Dataset, true, false, null, repo);
                CreateOrUpdateOperation("UnitsSKUDataset", "NewDashboard", ClaimTypes.Dataset, true, false, null, repo);
                CreateOrUpdateOperation("StockDataSet", "NewDashboard", ClaimTypes.Dataset, true, false, null, repo);
                CreateOrUpdateOperation("DeliveryScheduleDataSet", "NewDashboard", ClaimTypes.Dataset, true, false, null, repo);
                CreateOrUpdateOperation("LeadTimeDayDataSet", "NewDashboard", ClaimTypes.Dataset, true, false, null, repo);
                CreateOrUpdateOperation("ItemDataSet", "NewDashboard", ClaimTypes.Dataset, true, false, null, repo);
                CreateOrUpdateOperation("WarehouseDataSet", "NewDashboard", ClaimTypes.Dataset, true, false, null, repo);
                CreateOrUpdateOperation("StockSKUDataSet", "NewDashboard", ClaimTypes.Dataset, true, false, null, repo);
                CreateOrUpdateOperation("CategoryDataSet", "NewDashboard", ClaimTypes.Dataset, true, false, null, repo);
                CreateOrUpdateOperation("SubCategoryDataSet", "NewDashboard", ClaimTypes.Dataset, true, false, null, repo);
                CreateOrUpdateOperation("BusinessUnitDataSet", "NewDashboard", ClaimTypes.Dataset, true, false, null, repo);
                CreateOrUpdateOperation("BaseUnitDataSet", "NewDashboard", ClaimTypes.Dataset, true, false, null, repo);
                CreateOrUpdateOperation("Suppliers", "NewDashboard", ClaimTypes.Dataset, true, false, null, repo);
                CreateOrUpdateOperation("ForecastVS", "NewDashboard", ClaimTypes.Dataset, true, false, null, repo);
                CreateOrUpdateOperation("GeneralOperation", "OrderForecast", ClaimTypes.GenericAction, false, false,
                                        new [] { canViewOrderForecastPermission }, repo);
                CreateOrUpdateOperation("Retrieve", "OrderForecast", ClaimTypes.ControllerAction, false, false,
                                        new [] { canViewOrderForecastPermission }, repo);
                CreateOrUpdateOperation("OrderProposalDataSet", "OrderForecast", ClaimTypes.Dataset, false, false,
                                        new [] { canViewOrderForecastPermission }, repo);
                CreateOrUpdateOperation("GeneralOperation", "StockManagerView", ClaimTypes.GenericAction, false, false,
                                        new [] { isStockManagerPermission }, repo);
                CreateOrUpdateOperation("Render", "StockManagerView", ClaimTypes.ControllerAction, false, false,
                                        new [] { isStockManagerPermission }, repo);
                CreateOrUpdateOperation("AddSubcategory", "StockManagerView", ClaimTypes.ControllerAction, true, false, null, repo);
                CreateOrUpdateOperation("SelectForecast", "StockManagerView", ClaimTypes.ControllerAction, true, false, null, repo);
                CreateOrUpdateOperation("RecalculateForecast", "StockManagerView", ClaimTypes.ControllerAction, true, false, null, repo);
                CreateOrUpdateOperation("RefreshFilters", "StockManagerView", ClaimTypes.ControllerAction, true, false, null, repo);
                CreateOrUpdateOperation("AddSKU", "StockManagerView", ClaimTypes.ControllerAction, true, false, null, repo);
                CreateOrUpdateOperation("SendForecastToSupplier", "StockManagerView", ClaimTypes.ControllerAction, true, false, null, repo);
                CreateOrUpdateOperation("CollapseRight", "StockManagerView", ClaimTypes.ControllerAction, true, false, null, repo);
                CreateOrUpdateOperation("HandleRadioButton", "StockManagerView", ClaimTypes.ControllerAction, true, false, null, repo);
                CreateOrUpdateOperation("CollapseLeft", "StockManagerView", ClaimTypes.ControllerAction, true, false, null, repo);
                CreateOrUpdateOperation("EditedOFDetail", "StockManagerView", ClaimTypes.ControllerAction, true, false, null, repo);
                CreateOrUpdateOperation("ApplySupplierCoverageDaysToAllItems", "StockManagerView", ClaimTypes.ControllerAction, true, false, null, repo);
                CreateOrUpdateOperation("GoToFilteredKPIView", "StockManagerView", ClaimTypes.ControllerAction, true, false, null, repo);
                CreateOrUpdateOperation("CategoryDataSet", "StockManagerView", ClaimTypes.Dataset, false, false,
                                        new [] { isStockManagerPermission }, repo);
                CreateOrUpdateOperation("SubCategoryDataSet", "StockManagerView", ClaimTypes.Dataset, false, false,
                                        new [] { isStockManagerPermission }, repo);
                CreateOrUpdateOperation("BusinessUnitDataSet", "StockManagerView", ClaimTypes.Dataset, false, false,
                                        new [] { isStockManagerPermission }, repo);
                CreateOrUpdateOperation("OrderForecastsDS", "StockManagerView", ClaimTypes.Dataset, false, false,
                                        new [] { isStockManagerPermission }, repo);
                CreateOrUpdateOperation("ForecastVS", "StockManagerView", ClaimTypes.Dataset, false, false,
                                        new [] { isStockManagerPermission }, repo);
                CreateOrUpdateOperation("StockDataSet", "StockManagerView", ClaimTypes.Dataset, false, false,
                                        new [] { isStockManagerPermission }, repo);
                CreateOrUpdateOperation("NotificationsDS", "StockManagerView", ClaimTypes.Dataset, false, false,
                                        new [] { isStockManagerPermission }, repo);
                CreateOrUpdateOperation("SelectedOrderForecastDetailsDS", "StockManagerView", ClaimTypes.Dataset, false, false,
                                        new [] { isStockManagerPermission }, repo);
                CreateOrUpdateOperation("AllSubcategoriesDS", "StockManagerView", ClaimTypes.Dataset, false, false,
                                        new [] { isStockManagerPermission }, repo);
                CreateOrUpdateOperation("ItemsDS", "StockManagerView", ClaimTypes.Dataset, false, false,
                                        new [] { isStockManagerPermission }, repo);
                CreateOrUpdateOperation("ItemsVMDS", "StockManagerView", ClaimTypes.Dataset, false, false,
                                        new [] { isStockManagerPermission }, repo);
                CreateOrUpdateOperation("AllBaseUnitsDS", "StockManagerView", ClaimTypes.Dataset, false, false,
                                        new [] { isStockManagerPermission }, repo);
                CreateOrUpdateOperation("SuppliersDS", "StockManagerView", ClaimTypes.Dataset, false, false,
                                        new [] { isStockManagerPermission }, repo);
                CreateOrUpdateOperation("WarehousesDS", "StockManagerView", ClaimTypes.Dataset, false, false,
                                        new [] { isStockManagerPermission }, repo);
                CreateOrUpdateOperation("ListOptions", "StockManagerView", ClaimTypes.Dataset, false, false,
                                        new [] { isStockManagerPermission }, repo);
                CreateOrUpdateOperation("FlowTypes", "StockManagerView", ClaimTypes.Dataset, false, false,
                                        new [] { isStockManagerPermission }, repo);
                CreateOrUpdateOperation("Comments", "StockManagerView", ClaimTypes.Dataset, false, false,
                                        new [] { isStockManagerPermission }, repo);
                CreateOrUpdateOperation("SelectedForecastItems", "StockManagerView", ClaimTypes.Dataset, false, false,
                                        new [] { isStockManagerPermission }, repo);
                CreateOrUpdateOperation("FilteredItems", "StockManagerView", ClaimTypes.Dataset, false, false,
                                        new [] { isStockManagerPermission }, repo);
                CreateOrUpdateOperation("GeneralOperation", "StockSKUStatisticForm", ClaimTypes.GenericAction, true, true, null, repo);
                CreateOrUpdateOperation("Render", "StockSKUStatisticForm", ClaimTypes.ControllerAction, true, true, null, repo);
                CreateOrUpdateOperation("TotalUnitsSKU", "StockSKUStatisticForm", ClaimTypes.ControllerAction, true, true, null, repo);
                CreateOrUpdateOperation("UnitsSKUDataSet", "StockSKUStatisticForm", ClaimTypes.Dataset, true, true, null, repo);
                CreateOrUpdateOperation("GeneralOperation", "SupplierForm", ClaimTypes.GenericAction, true, true, null, repo);
                CreateOrUpdateOperation("AddSupplier", "SupplierForm", ClaimTypes.ControllerAction, true, true, null, repo);
                CreateOrUpdateOperation("EditSupplier", "SupplierForm", ClaimTypes.ControllerAction, true, true, null, repo);
                CreateOrUpdateOperation("SaveSupplier", "SupplierForm", ClaimTypes.ControllerAction, true, true, null, repo);
                CreateOrUpdateOperation("DeleteSupplier", "SupplierForm", ClaimTypes.ControllerAction, true, true, null, repo);
                CreateOrUpdateOperation("GeneralOperation", "SupplierOrderForecast", ClaimTypes.GenericAction, false, false,
                                        new [] { canViewEditableOrderForecastPermission }, repo);
                CreateOrUpdateOperation("Retrieve", "SupplierOrderForecast", ClaimTypes.ControllerAction, false, false,
                                        new [] { canViewEditableOrderForecastPermission }, repo);
                CreateOrUpdateOperation("OrderProposalDataSet", "SupplierOrderForecast", ClaimTypes.Dataset, false, false,
                                        new [] { canViewEditableOrderForecastPermission }, repo);
                CreateOrUpdateOperation("GeneralOperation", "SupplierView", ClaimTypes.GenericAction, false, false,
                                        new [] { isSupplierPermission }, repo);
                CreateOrUpdateOperation("Render", "SupplierView", ClaimTypes.ControllerAction, false, false,
                                        new [] { isSupplierPermission }, repo);
                CreateOrUpdateOperation("AddSubcategory", "SupplierView", ClaimTypes.ControllerAction, true, false, null, repo);
                CreateOrUpdateOperation("SelectForecast", "SupplierView", ClaimTypes.ControllerAction, true, false, null, repo);
                CreateOrUpdateOperation("RecalculateForecast", "SupplierView", ClaimTypes.ControllerAction, true, false, null, repo);
                CreateOrUpdateOperation("RefreshFilters", "SupplierView", ClaimTypes.ControllerAction, true, false, null, repo);
                CreateOrUpdateOperation("AddSKU", "SupplierView", ClaimTypes.ControllerAction, true, false, null, repo);
                CreateOrUpdateOperation("CollapseLeft", "SupplierView", ClaimTypes.ControllerAction, true, false, null, repo);
                CreateOrUpdateOperation("ReplyToOrderForecast", "SupplierView", ClaimTypes.ControllerAction, true, false, null, repo);
                CreateOrUpdateOperation("SendForecastToSupplier", "SupplierView", ClaimTypes.ControllerAction, true, false, null, repo);
                CreateOrUpdateOperation("AcceptAllOrderFDetails", "SupplierView", ClaimTypes.ControllerAction, true, false, null, repo);
                CreateOrUpdateOperation("ListUpdate", "SupplierView", ClaimTypes.ControllerAction, true, false, null, repo);
                CreateOrUpdateOperation("ShowRecommendations", "SupplierView", ClaimTypes.ControllerAction, true, false, null, repo);
                CreateOrUpdateOperation("ShowAll", "SupplierView", ClaimTypes.ControllerAction, true, false, null, repo);
                CreateOrUpdateOperation("ShowAlerts", "SupplierView", ClaimTypes.ControllerAction, true, false, null, repo);
                CreateOrUpdateOperation("HandleRadioButton", "SupplierView", ClaimTypes.ControllerAction, true, false, null, repo);
                CreateOrUpdateOperation("ModalNo", "SupplierView", ClaimTypes.ControllerAction, true, false, null, repo);
                CreateOrUpdateOperation("ModalNoExcessStock", "SupplierView", ClaimTypes.ControllerAction, true, false, null, repo);
                CreateOrUpdateOperation("ResolveOfDetails", "SupplierView", ClaimTypes.ControllerAction, true, false, null, repo);
                CreateOrUpdateOperation("CategoryDataSet", "SupplierView", ClaimTypes.Dataset, false, false,
                                        new [] { isSupplierPermission }, repo);
                CreateOrUpdateOperation("SubCategoryDataSet", "SupplierView", ClaimTypes.Dataset, false, false,
                                        new [] { isSupplierPermission }, repo);
                CreateOrUpdateOperation("BusinessUnitDataSet", "SupplierView", ClaimTypes.Dataset, false, false,
                                        new [] { isSupplierPermission }, repo);
                CreateOrUpdateOperation("OrderForecastsDS", "SupplierView", ClaimTypes.Dataset, false, false,
                                        new [] { isSupplierPermission }, repo);
                CreateOrUpdateOperation("ForecastVS", "SupplierView", ClaimTypes.Dataset, false, false,
                                        new [] { isSupplierPermission }, repo);
                CreateOrUpdateOperation("StockDataSet", "SupplierView", ClaimTypes.Dataset, false, false,
                                        new [] { isSupplierPermission }, repo);
                CreateOrUpdateOperation("NotificationsDS", "SupplierView", ClaimTypes.Dataset, false, false,
                                        new [] { isSupplierPermission }, repo);
                CreateOrUpdateOperation("SelectedOrderForecastDetailsDS", "SupplierView", ClaimTypes.Dataset, false, false,
                                        new [] { isSupplierPermission }, repo);
                CreateOrUpdateOperation("AllSubcategoriesDS", "SupplierView", ClaimTypes.Dataset, false, false,
                                        new [] { isSupplierPermission }, repo);
                CreateOrUpdateOperation("ItemsDS", "SupplierView", ClaimTypes.Dataset, false, false,
                                        new [] { isSupplierPermission }, repo);
                CreateOrUpdateOperation("ItemsVMDS", "SupplierView", ClaimTypes.Dataset, false, false,
                                        new [] { isSupplierPermission }, repo);
                CreateOrUpdateOperation("AllBaseUnitsDS", "SupplierView", ClaimTypes.Dataset, false, false,
                                        new [] { isSupplierPermission }, repo);
                CreateOrUpdateOperation("SuppliersDS", "SupplierView", ClaimTypes.Dataset, false, false,
                                        new [] { isSupplierPermission }, repo);
                CreateOrUpdateOperation("WarehousesDS", "SupplierView", ClaimTypes.Dataset, false, false,
                                        new [] { isSupplierPermission }, repo);
                CreateOrUpdateOperation("SelectedOrderFDetailsVM", "SupplierView", ClaimTypes.Dataset, false, false,
                                        new [] { isSupplierPermission }, repo);
                CreateOrUpdateOperation("ListOptions", "SupplierView", ClaimTypes.Dataset, false, false,
                                        new [] { isSupplierPermission }, repo);
                CreateOrUpdateOperation("FlowTypes", "SupplierView", ClaimTypes.Dataset, false, false,
                                        new [] { isSupplierPermission }, repo);
                CreateOrUpdateOperation("Commets", "SupplierView", ClaimTypes.Dataset, false, false,
                                        new [] { isSupplierPermission }, repo);
                CreateOrUpdateOperation("GeneralOperation", "Test", ClaimTypes.GenericAction, true, true, null, repo);
                CreateOrUpdateOperation("Render", "Test", ClaimTypes.ControllerAction, true, true, null, repo);
                CreateOrUpdateOperation("RefreshChart", "Test", ClaimTypes.ControllerAction, true, true, null, repo);
                CreateOrUpdateOperation("StockOnHandDataSet", "Test", ClaimTypes.Dataset, true, true, null, repo);
                CreateOrUpdateOperation("BusinessUnitDataSet", "Test", ClaimTypes.Dataset, true, true, null, repo);
                CreateOrUpdateOperation("CategoryDataSet", "Test", ClaimTypes.Dataset, true, true, null, repo);
                CreateOrUpdateOperation("SubCategoryDataSet", "Test", ClaimTypes.Dataset, true, true, null, repo);
                CreateOrUpdateOperation("BaseUnitDataSet", "Test", ClaimTypes.Dataset, true, true, null, repo);
                CreateOrUpdateOperation("ItemDataSet", "Test", ClaimTypes.Dataset, true, true, null, repo);
                CreateOrUpdateOperation("GeneralOperation", "ThemePreview", ClaimTypes.GenericAction, true, true, null, repo);
                CreateOrUpdateOperation("Render", "ThemePreview", ClaimTypes.ControllerAction, true, true, null, repo);
                CreateOrUpdateOperation("ApplicationOperationDataSet", "ThemePreview", ClaimTypes.Dataset, true, true, null, repo);
                CreateOrUpdateOperation("CalendarSet", "ThemePreview", ClaimTypes.Dataset, true, true, null, repo);
                CreateOrUpdateOperation("Days", "ThemePreview", ClaimTypes.Dataset, true, true, null, repo);
                CreateOrUpdateOperation("GeneralOperation", "WarehouseForm", ClaimTypes.GenericAction, true, true, null, repo);
                CreateOrUpdateOperation("AddWarehouse", "WarehouseForm", ClaimTypes.ControllerAction, true, true, null, repo);
                CreateOrUpdateOperation("EditWarehouse", "WarehouseForm", ClaimTypes.ControllerAction, true, true, null, repo);
                CreateOrUpdateOperation("SaveWarehouse", "WarehouseForm", ClaimTypes.ControllerAction, true, true, null, repo);
                CreateOrUpdateOperation("DeleteWarehouse", "WarehouseForm", ClaimTypes.ControllerAction, true, true, null, repo);
                CreateOrUpdateOperation("GeneralOperation", "Dashboard", ClaimTypes.GenericAction, true, true, null, repo);
                CreateOrUpdateOperation("Render", "Dashboard", ClaimTypes.ControllerAction, true, true, null, repo);
                CreateOrUpdateOperation("ApplicationOperationDataSet", "Dashboard", ClaimTypes.Dataset, true, true, null, repo);
                CreateOrUpdateOperation("ApplicationRoleDataSet", "Dashboard", ClaimTypes.Dataset, true, true, null, repo);
                CreateOrUpdateOperation("GeneralOperation", "NewContact", ClaimTypes.GenericAction, false, false,
                                        new [] { manageUsersPermission }, repo);
                CreateOrUpdateOperation("NewUser", "NewContact", ClaimTypes.ControllerAction, false, false,
                                        new [] { manageUsersPermission }, repo);
                CreateOrUpdateOperation("EditUser", "NewContact", ClaimTypes.ControllerAction, false, false,
                                        new [] { manageUsersPermission }, repo);
                CreateOrUpdateOperation("SaveUser", "NewContact", ClaimTypes.ControllerAction, false, false,
                                        new [] { manageUsersPermission }, repo);
                CreateOrUpdateOperation("DeleteUser", "NewContact", ClaimTypes.ControllerAction, false, false,
                                        new [] { manageUsersPermission }, repo);
                CreateOrUpdateOperation("Button1Changed", "NewContact", ClaimTypes.ControllerAction, true, true, null, repo);
                CreateOrUpdateOperation("Button2Changed", "NewContact", ClaimTypes.ControllerAction, true, true, null, repo);
                CreateOrUpdateOperation("Button1DataSet", "NewContact", ClaimTypes.Dataset, false, false,
                                        new [] { manageUsersPermission }, repo);
                CreateOrUpdateOperation("Button2DataSet", "NewContact", ClaimTypes.Dataset, false, false,
                                        new [] { manageUsersPermission }, repo);
                CreateOrUpdateOperation("Suppliers", "NewContact", ClaimTypes.Dataset, false, false,
                                        new [] { manageUsersPermission }, repo);
                CreateOrUpdateOperation("Publish", "capacities", ClaimTypes.ExposedService, true, false, null, repo);
                CreateOrUpdateOperation("Import", "deliveryDays", ClaimTypes.ExposedService, true, false, null, repo);
                CreateOrUpdateOperation("Export", "exportInventoryItems", ClaimTypes.ExposedService, true, true, null, repo);
                CreateOrUpdateOperation("Export", "exportItems", ClaimTypes.ExposedService, true, false, null, repo);
                CreateOrUpdateOperation("ExportOFDetails", "exportOFDetails", ClaimTypes.ExposedService, true, false, null, repo);
                CreateOrUpdateOperation("ExportSalesForecastDetails", "exportSalesForecastDetails", ClaimTypes.ExposedService, true, false, null, repo);
                CreateOrUpdateOperation("Import", "inventoryItems", ClaimTypes.ExposedService, true, false, null, repo);
                CreateOrUpdateOperation("Import", "items", ClaimTypes.ExposedService, true, false, null, repo);
                CreateOrUpdateOperation("Import", "minimumQuantities", ClaimTypes.ExposedService, true, false, null, repo);
                CreateOrUpdateOperation("CalculateForSKU", "OrderForecastService", ClaimTypes.ExposedService, true, false, null, repo);
                CreateOrUpdateOperation("Import", "pastOrders", ClaimTypes.ExposedService, true, false, null, repo);
                CreateOrUpdateOperation("Import", "pastSales", ClaimTypes.ExposedService, true, false, null, repo);
                CreateOrUpdateOperation("Import", "salesForecasts", ClaimTypes.ExposedService, true, false, null, repo);
                CreateOrUpdateOperation("Import", "stocksOnHand", ClaimTypes.ExposedService, true, false, null, repo);
                #endregion
                #region Roles
                allRoles = new List<ApplicationRole>
                {
                    CreateOrUpdateRole("Administrator", "Administrator",
                    new [] { manageUsersPermission, manageRolesPermission, managePermissionsPermission, manageOperationsPermission, manageSettingsPermission, manageApplicationDataPermission, isStockManagerPermission }, repo),
                    CreateOrUpdateRole("Retailer", "",
                    new [] { canViewOrderForecastPermission, customerSelectionAndAdminAddPermission, isStockManagerPermission }, repo),
                    CreateOrUpdateRole("HighTrustSupplier", "",
                    new [] { canViewOrderForecastPermission, canViewEditableOrderForecastPermission }, repo),
                    CreateOrUpdateRole("MediumTrustSupplier", "",
                    new [] { canViewEditableOrderForecastPermission }, repo),
                    CreateOrUpdateRole("Supplier", "Supplier View",
                    new [] { isSupplierPermission }, repo),
                };
                #endregion
            });
            watch.Stop();
            log4net.LogManager.GetLogger(typeof(DatabaseSeeder)).Info($"Startup.Database finished in {watch.ElapsedMilliseconds}ms");
        }
    }
}
