
// Copyright (c) CLMS. All rights reserved.
// Licensed under the AGPL-3.0 license. See LICENSE file in the project root for full license information.
// This source file was autogenerated by zAppDev(r).

using System;
using System.Runtime.Serialization;
using System.Collections.Generic;
using System.ComponentModel;
using System.Linq;
using System.Reflection;
using System.Collections;
using zAppDev.DotNet.Framework.Utilities;
using zAppDev.DotNet.Framework.Configuration;
using zAppDev.DotNet.Framework.Data.Domain;

using DSS1_RetailerDriverStockOptimisation.DAL;

namespace DSS1_RetailerDriverStockOptimisation.BO
{
	/// <summary>
	/// The MakeRequest extensions
	/// </summary>
	public static class MakeRequestExtensions
	{
        public static DSS1_RetailerDriverStockOptimisation.ExternalStructs.Elasticsearch.SearchRequest Query(string q, string fromDate, string toDate){using (new zAppDev.DotNet.Framework.Profiling.Profiler("MakeRequest", zAppDev.DotNet.Framework.Profiling.AppDevSymbolType.ClassOperation, "Query")) {
DSS1_RetailerDriverStockOptimisation.ExternalStructs.Elasticsearch.SearchRequest searchObject = new DSS1_RetailerDriverStockOptimisation.ExternalStructs.Elasticsearch.SearchRequest();
System.Collections.Generic.List<DSS1_RetailerDriverStockOptimisation.ExternalStructs.Elasticsearch.Sort> sorts = new System.Collections.Generic.List<DSS1_RetailerDriverStockOptimisation.ExternalStructs.Elasticsearch.Sort>();
sorts.Add(DSS1_RetailerDriverStockOptimisation.BO.MakeRequestExtensions.SortByTimestamp("desc"));
searchObject.sort = sorts.ToList();searchObject.query = DSS1_RetailerDriverStockOptimisation.BO.MakeRequestExtensions.GetQuery(q, fromDate, toDate);DSS1_RetailerDriverStockOptimisation.ExternalStructs.Elasticsearch.Meta meta = new DSS1_RetailerDriverStockOptimisation.ExternalStructs.Elasticsearch.Meta();
meta.excludes = new string[] { "message" };searchObject.source = meta;return searchObject;
}
}


public static DSS1_RetailerDriverStockOptimisation.ExternalStructs.Elasticsearch.AnalyticsRequest Analytics(string q, string fromDate, string toDate){using (new zAppDev.DotNet.Framework.Profiling.Profiler("MakeRequest", zAppDev.DotNet.Framework.Profiling.AppDevSymbolType.ClassOperation, "Analytics")) {
DSS1_RetailerDriverStockOptimisation.ExternalStructs.Elasticsearch.AnalyticsRequest analyticsObject = new DSS1_RetailerDriverStockOptimisation.ExternalStructs.Elasticsearch.AnalyticsRequest();
analyticsObject.query = DSS1_RetailerDriverStockOptimisation.BO.MakeRequestExtensions.GetQuery(q, fromDate, toDate);string interval = DSS1_RetailerDriverStockOptimisation.BO.MakeRequestExtensions.GetInterval(fromDate);
analyticsObject.aggs = DSS1_RetailerDriverStockOptimisation.BO.MakeRequestExtensions.GetAggregations(interval);DSS1_RetailerDriverStockOptimisation.ExternalStructs.Elasticsearch.Meta meta = new DSS1_RetailerDriverStockOptimisation.ExternalStructs.Elasticsearch.Meta();
meta.excludes = new string[] { "message" };analyticsObject.source = meta;return analyticsObject;
}
}


public static DSS1_RetailerDriverStockOptimisation.ExternalStructs.Elasticsearch.TermAggregatorRoot GetTermQuery(string field, int? size, bool aggsEnable){using (new zAppDev.DotNet.Framework.Profiling.Profiler("MakeRequest", zAppDev.DotNet.Framework.Profiling.AppDevSymbolType.ClassOperation, "GetTermQuery")) {
DSS1_RetailerDriverStockOptimisation.ExternalStructs.Elasticsearch.TermAggregatorRoot q = new DSS1_RetailerDriverStockOptimisation.ExternalStructs.Elasticsearch.TermAggregatorRoot();
DSS1_RetailerDriverStockOptimisation.ExternalStructs.Elasticsearch.TermAggregator term = new DSS1_RetailerDriverStockOptimisation.ExternalStructs.Elasticsearch.TermAggregator();
q.terms = term;term.field = field;if ((aggsEnable)) {
DSS1_RetailerDriverStockOptimisation.ExternalStructs.Elasticsearch.TermsAggregationRequest aggs = new DSS1_RetailerDriverStockOptimisation.ExternalStructs.Elasticsearch.TermsAggregationRequest();
q.Aggs = aggs;q.Aggs.ResposeStatus = DSS1_RetailerDriverStockOptimisation.BO.MakeRequestExtensions.GetErrorFilter();q.Aggs.ResponseTime = DSS1_RetailerDriverStockOptimisation.BO.MakeRequestExtensions.GetStatQuery("ElapsedMsecs");}
if ((size > 0)) {
term.size = size;}
return q;
}
}


public static DSS1_RetailerDriverStockOptimisation.ExternalStructs.Elasticsearch.StatsAggregatorRoot GetStatQuery(string field){using (new zAppDev.DotNet.Framework.Profiling.Profiler("MakeRequest", zAppDev.DotNet.Framework.Profiling.AppDevSymbolType.ClassOperation, "GetStatQuery")) {
DSS1_RetailerDriverStockOptimisation.ExternalStructs.Elasticsearch.StatsAggregatorRoot q = new DSS1_RetailerDriverStockOptimisation.ExternalStructs.Elasticsearch.StatsAggregatorRoot();
DSS1_RetailerDriverStockOptimisation.ExternalStructs.Elasticsearch.StatsAggregator stats = new DSS1_RetailerDriverStockOptimisation.ExternalStructs.Elasticsearch.StatsAggregator();
q.stats = stats;stats.field = field;return q;
}
}


public static DSS1_RetailerDriverStockOptimisation.ExternalStructs.Elasticsearch.Must GetQueryStringQuery(string q){using (new zAppDev.DotNet.Framework.Profiling.Profiler("MakeRequest", zAppDev.DotNet.Framework.Profiling.AppDevSymbolType.ClassOperation, "GetQueryStringQuery")) {
DSS1_RetailerDriverStockOptimisation.ExternalStructs.Elasticsearch.Must must = new DSS1_RetailerDriverStockOptimisation.ExternalStructs.Elasticsearch.Must();
if (((q == null || q == ""))) {
zAppDev.DotNet.Framework.Utilities.Serializer<DSS1_RetailerDriverStockOptimisation.ExternalStructs.Elasticsearch.MatchAll> serializer = new zAppDev.DotNet.Framework.Utilities.Serializer<DSS1_RetailerDriverStockOptimisation.ExternalStructs.Elasticsearch.MatchAll>();
must.match_all = serializer.FromJson("{\"must\": {\"match_all\": {}}");}
else {
DSS1_RetailerDriverStockOptimisation.ExternalStructs.Elasticsearch.QueryString queryString = new DSS1_RetailerDriverStockOptimisation.ExternalStructs.Elasticsearch.QueryString();
queryString.AnalyzeWildcard = true;queryString.Query = q;must.QueryString = queryString;}
return must;
}
}


public static DSS1_RetailerDriverStockOptimisation.ExternalStructs.Elasticsearch.HistogramRoot GetHistogramQuery(string field, string interval){using (new zAppDev.DotNet.Framework.Profiling.Profiler("MakeRequest", zAppDev.DotNet.Framework.Profiling.AppDevSymbolType.ClassOperation, "GetHistogramQuery")) {
DSS1_RetailerDriverStockOptimisation.ExternalStructs.Elasticsearch.HistogramRoot q = new DSS1_RetailerDriverStockOptimisation.ExternalStructs.Elasticsearch.HistogramRoot();
DSS1_RetailerDriverStockOptimisation.ExternalStructs.Elasticsearch.Histogram hist = new DSS1_RetailerDriverStockOptimisation.ExternalStructs.Elasticsearch.Histogram();
q.DateHistogram = hist;hist.Field = field;hist.Interval = interval;hist.Format = DSS1_RetailerDriverStockOptimisation.BO.MakeRequestExtensions.GetDateFormat(interval);hist.Offset = "+0h";DSS1_RetailerDriverStockOptimisation.ExternalStructs.Elasticsearch.Statistics stats = new DSS1_RetailerDriverStockOptimisation.ExternalStructs.Elasticsearch.Statistics();
stats.statistics = DSS1_RetailerDriverStockOptimisation.BO.MakeRequestExtensions.GetStatQuery("ElapsedMsecs");stats.errors = DSS1_RetailerDriverStockOptimisation.BO.MakeRequestExtensions.GetErrorFilter();q.Aggregator = stats;return q;
}
}


public static DSS1_RetailerDriverStockOptimisation.ExternalStructs.Elasticsearch.BucketHistogramRoot GetBucketHistogramQuery(string field, int? interval){using (new zAppDev.DotNet.Framework.Profiling.Profiler("MakeRequest", zAppDev.DotNet.Framework.Profiling.AppDevSymbolType.ClassOperation, "GetBucketHistogramQuery")) {
DSS1_RetailerDriverStockOptimisation.ExternalStructs.Elasticsearch.BucketHistogramRoot q = new DSS1_RetailerDriverStockOptimisation.ExternalStructs.Elasticsearch.BucketHistogramRoot();
DSS1_RetailerDriverStockOptimisation.ExternalStructs.Elasticsearch.BucketHistogram hist = new DSS1_RetailerDriverStockOptimisation.ExternalStructs.Elasticsearch.BucketHistogram();
q.Histogram = hist;hist.Field = field;hist.Interval = interval;return q;
}
}


public static DSS1_RetailerDriverStockOptimisation.ExternalStructs.Elasticsearch.Range GetFilterByTimePeriod(string fromDate, string toDate){using (new zAppDev.DotNet.Framework.Profiling.Profiler("MakeRequest", zAppDev.DotNet.Framework.Profiling.AppDevSymbolType.ClassOperation, "GetFilterByTimePeriod")) {
if (((fromDate == null || fromDate == ""))) {
fromDate = "now-1w";}
if (((toDate == null || toDate == ""))) {
toDate = "now";}
DSS1_RetailerDriverStockOptimisation.ExternalStructs.Elasticsearch.Range timeRange = new DSS1_RetailerDriverStockOptimisation.ExternalStructs.Elasticsearch.Range();
DSS1_RetailerDriverStockOptimisation.ExternalStructs.Elasticsearch.Timestamp timestamp = new DSS1_RetailerDriverStockOptimisation.ExternalStructs.Elasticsearch.Timestamp();
timestamp.gte = fromDate;timestamp.lte = toDate;timeRange.timestamp = timestamp;return timeRange;
}
}


public static DSS1_RetailerDriverStockOptimisation.ExternalStructs.Elasticsearch.Sort SortByTimestamp(string direction){using (new zAppDev.DotNet.Framework.Profiling.Profiler("MakeRequest", zAppDev.DotNet.Framework.Profiling.AppDevSymbolType.ClassOperation, "SortByTimestamp")) {
if (((direction == null || direction == ""))) {
direction = "desc";}
DSS1_RetailerDriverStockOptimisation.ExternalStructs.Elasticsearch.Sort sortObject = new DSS1_RetailerDriverStockOptimisation.ExternalStructs.Elasticsearch.Sort();
DSS1_RetailerDriverStockOptimisation.ExternalStructs.Elasticsearch.Order orderObject = new DSS1_RetailerDriverStockOptimisation.ExternalStructs.Elasticsearch.Order();
orderObject.order = direction;sortObject.Timestamp = orderObject;return sortObject;
}
}


public static DSS1_RetailerDriverStockOptimisation.ExternalStructs.Elasticsearch.Query GetQuery(string q, string fromDate, string toDate){using (new zAppDev.DotNet.Framework.Profiling.Profiler("MakeRequest", zAppDev.DotNet.Framework.Profiling.AppDevSymbolType.ClassOperation, "GetQuery")) {
if (((fromDate == null || fromDate == ""))) {
fromDate = "now-1w";}
if (((toDate == null || toDate == ""))) {
toDate = "now";}
DSS1_RetailerDriverStockOptimisation.ExternalStructs.Elasticsearch.Query queryObject = new DSS1_RetailerDriverStockOptimisation.ExternalStructs.Elasticsearch.Query();
DSS1_RetailerDriverStockOptimisation.ExternalStructs.Elasticsearch.Logic logic = new DSS1_RetailerDriverStockOptimisation.ExternalStructs.Elasticsearch.Logic();
logic.must = DSS1_RetailerDriverStockOptimisation.BO.MakeRequestExtensions.GetQueryStringQuery(q);DSS1_RetailerDriverStockOptimisation.ExternalStructs.Elasticsearch.Filter filter = new DSS1_RetailerDriverStockOptimisation.ExternalStructs.Elasticsearch.Filter();
filter.range = DSS1_RetailerDriverStockOptimisation.BO.MakeRequestExtensions.GetFilterByTimePeriod(fromDate, toDate);logic.filter = filter;queryObject.logic = logic;return queryObject;
}
}


public static DSS1_RetailerDriverStockOptimisation.ExternalStructs.Elasticsearch.OBAggregatorRequest GetAggregations(string interval){using (new zAppDev.DotNet.Framework.Profiling.Profiler("MakeRequest", zAppDev.DotNet.Framework.Profiling.AppDevSymbolType.ClassOperation, "GetAggregations")) {
DSS1_RetailerDriverStockOptimisation.ExternalStructs.Elasticsearch.OBAggregatorRequest aggs = new DSS1_RetailerDriverStockOptimisation.ExternalStructs.Elasticsearch.OBAggregatorRequest();
DSS1_RetailerDriverStockOptimisation.ExternalStructs.Elasticsearch.TermAggregatorRoot top_service = DSS1_RetailerDriverStockOptimisation.BO.MakeRequestExtensions.GetTermQuery("Service.keyword", 5, true);
DSS1_RetailerDriverStockOptimisation.ExternalStructs.Elasticsearch.TermAggregatorRoot top_operation = DSS1_RetailerDriverStockOptimisation.BO.MakeRequestExtensions.GetTermQuery("Operation.keyword", 5, true);
DSS1_RetailerDriverStockOptimisation.ExternalStructs.Elasticsearch.TermAggregatorRoot from_ip = DSS1_RetailerDriverStockOptimisation.BO.MakeRequestExtensions.GetTermQuery("IP.keyword", 5, true);
DSS1_RetailerDriverStockOptimisation.ExternalStructs.Elasticsearch.TermAggregatorRoot verb_type = DSS1_RetailerDriverStockOptimisation.BO.MakeRequestExtensions.GetTermQuery("RequestMethod.keyword", 5, true);
DSS1_RetailerDriverStockOptimisation.ExternalStructs.Elasticsearch.TermAggregatorRoot status = DSS1_RetailerDriverStockOptimisation.BO.MakeRequestExtensions.GetTermQuery("StatusCode", 5, true);
DSS1_RetailerDriverStockOptimisation.ExternalStructs.Elasticsearch.StatsAggregatorRoot elapsed_msecs = DSS1_RetailerDriverStockOptimisation.BO.MakeRequestExtensions.GetStatQuery("ElapsedMsecs");
DSS1_RetailerDriverStockOptimisation.ExternalStructs.Elasticsearch.HistogramRoot req_over_time = DSS1_RetailerDriverStockOptimisation.BO.MakeRequestExtensions.GetHistogramQuery("Timestamp", interval);
DSS1_RetailerDriverStockOptimisation.ExternalStructs.Elasticsearch.BucketHistogramRoot req_latency = DSS1_RetailerDriverStockOptimisation.BO.MakeRequestExtensions.GetBucketHistogramQuery("ElapsedMsecs", 2000);
aggs.TopService = top_service;aggs.TopOperation = top_operation;aggs.FromIP = from_ip;aggs.VerbType = verb_type;aggs.Status = status;aggs.ElapsedMsecs = elapsed_msecs;aggs.RequestOverTime = req_over_time;aggs.RequestLatency = req_latency;aggs.Errors = DSS1_RetailerDriverStockOptimisation.BO.MakeRequestExtensions.GetErrorFilter();return aggs;
}
}


public static DSS1_RetailerDriverStockOptimisation.ExternalStructs.Elasticsearch.ErrorFilterAgg GetErrorFilter(){using (new zAppDev.DotNet.Framework.Profiling.Profiler("MakeRequest", zAppDev.DotNet.Framework.Profiling.AppDevSymbolType.ClassOperation, "GetErrorFilter")) {
DSS1_RetailerDriverStockOptimisation.ExternalStructs.Elasticsearch.ErrorFilterAgg errorFilter = new DSS1_RetailerDriverStockOptimisation.ExternalStructs.Elasticsearch.ErrorFilterAgg();
DSS1_RetailerDriverStockOptimisation.ExternalStructs.Elasticsearch.FiltersAggRoot filterRoot = new DSS1_RetailerDriverStockOptimisation.ExternalStructs.Elasticsearch.FiltersAggRoot();
DSS1_RetailerDriverStockOptimisation.ExternalStructs.Elasticsearch.FiltersAgg filter = new DSS1_RetailerDriverStockOptimisation.ExternalStructs.Elasticsearch.FiltersAgg();
DSS1_RetailerDriverStockOptimisation.ExternalStructs.Elasticsearch.FiltersRangeRootAgg failureRoot = new DSS1_RetailerDriverStockOptimisation.ExternalStructs.Elasticsearch.FiltersRangeRootAgg();
DSS1_RetailerDriverStockOptimisation.ExternalStructs.Elasticsearch.FiltersRangeRootAgg successRoot = new DSS1_RetailerDriverStockOptimisation.ExternalStructs.Elasticsearch.FiltersRangeRootAgg();
DSS1_RetailerDriverStockOptimisation.ExternalStructs.Elasticsearch.FiltersRangeAgg failure = new DSS1_RetailerDriverStockOptimisation.ExternalStructs.Elasticsearch.FiltersRangeAgg();
DSS1_RetailerDriverStockOptimisation.ExternalStructs.Elasticsearch.FiltersRangeAgg success = new DSS1_RetailerDriverStockOptimisation.ExternalStructs.Elasticsearch.FiltersRangeAgg();
DSS1_RetailerDriverStockOptimisation.ExternalStructs.Elasticsearch.Timestamp timestampFailure = new DSS1_RetailerDriverStockOptimisation.ExternalStructs.Elasticsearch.Timestamp();
timestampFailure.gte = "400";failure.StatusCode = timestampFailure;failureRoot.Range = failure;filter.Failure = failureRoot;DSS1_RetailerDriverStockOptimisation.ExternalStructs.Elasticsearch.Timestamp timestampSuccess = new DSS1_RetailerDriverStockOptimisation.ExternalStructs.Elasticsearch.Timestamp();
timestampSuccess.lt = "400";success.StatusCode = timestampSuccess;successRoot.Range = success;filter.Success = successRoot;filterRoot.Filters = filter;errorFilter.Filters = filterRoot;return errorFilter;
}
}


public static string GetInterval(string fromDate){using (new zAppDev.DotNet.Framework.Profiling.Profiler("MakeRequest", zAppDev.DotNet.Framework.Profiling.AppDevSymbolType.ClassOperation, "GetInterval")) {
if ((fromDate == "now-1y")) {
return "month";
}
else if ((fromDate == "now-1M")) {
return "day";
}
else if ((fromDate == "now-1w")) {
return "6h";
}
else if ((fromDate == "now-1d")) {
return "hour";
}
else {
return "day";
}
}
}


public static string GetDateFormat(string interval){using (new zAppDev.DotNet.Framework.Profiling.Profiler("MakeRequest", zAppDev.DotNet.Framework.Profiling.AppDevSymbolType.ClassOperation, "GetDateFormat")) {
if ((interval == "month")) {
return "yyyy-MM";
}
else if ((interval == "day")) {
return "yyyy-MM-dd";
}
else if ((interval == "6h")) {
return "yyyy-MM-dd HH:mm";
}
else if ((interval == "h")) {
return "yyyy-MM-dd HH:mm";
}
else {
return "yyyy-MM-dd HH:mm";
}
}
}



        
	}
}
